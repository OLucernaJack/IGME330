(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var t,n,r,o,a,i,c,l=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")")},u=function(e,t){return Math.random()*(t-e)+e},s=Object.freeze({gain:.5,numSamples:256}),f=(new Uint8Array(s.numSamples/2),function(e){n.src=e});function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function y(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}var m,g,b,p,w,S=function(){return e=function e(t,n,r,o,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,{x:t,y:n,radius:r,color:o,MAX:a,MIN:i}),Object.seal(this)},t=[{key:"update",value:function(e){var t=1;e.showFreq&&(this.y=5,(this.x<this.MIN||this.x>this.MAX)&&(t*=-1,this.x+=t),this.x+=t),e.showTime&&(this.x=5,(this.y<this.MIN||this.y>this.MAX)&&(t*=-1,this.y+=t),this.y+=t)}},{key:"draw",value:function(e){e.save(),e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.closePath(),e.fillStyle=this.color,e.fill(),e.restore()}}],t&&v(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),q=0,A=[],T=function(t,n){m=t.getContext("2d"),g=t.width,b=t.height,function(t,n,r,o,a,i){var c,l=t.createLinearGradient(0,0,0,a),u=function(t,n){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,i=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw i}}}}([{percent:0,color:"blue"},{percent:.25,color:"lightseagreen"},{percent:.5,color:"aquamarine"},{percent:.75,color:"skyblue"},{percent:1,color:"slateblue"}]);try{for(u.s();!(c=u.n()).done;){var s=c.value;l.addColorStop(s.percent,s.color)}}catch(e){u.e(e)}finally{u.f()}}(m,0,0,0,b),p=n,w=new Uint8Array(p.fftSize/2)},M={showGradient:!0,showBars:!0,showCircles:!0,showNoise:!1,showInvert:!1,volumeLevel:0,showFreq:!0,showTime:!1},I=Object.freeze({sound1:"./media/New Adventure Theme.mp3"}),k=function(e){var r=document.querySelector("#btn-fs"),o=document.querySelector("#btn-play");r.onclick=function(t){var n;console.log("goFullscreen() called"),(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()},o.onclick=function(e){console.log("audioCtx.state before = ".concat(t.state)),"suspended"==t.state&&t.resume(),console.log("audioCtx.state after = ".concat(t.state)),"no"==e.target.dataset.playing?(n.play(),e.target.dataset.playing="yes"):(n.pause(),e.target.dataset.playing="no")};var l=document.querySelector("#vol-slide"),u=document.querySelector("#vol-label");l.oninput=function(e){var t;t=e.target.value,t=Number(t),c.gain.value=t,u.innerHTML=Math.round(e.target.value/2*100),M.volumeLevel=Math.round(e.target.value/2*100)},l.dispatchEvent(new Event("input")),document.querySelector("#select-track").onchange=function(e){f(e.target.value),"yes"==o.dataset.playing&&o.dispatchEvent(new MouseEvent("click"))};var s=document.querySelector("#select-data");s.onchange=function(e){"frequency-data"==s.value?(M.showFreq=!0,M.showTime=!1):(M.showFreq=!1,M.showTime=!0)};var h=document.querySelector("#highshelf-cb"),d=document.querySelector("#lowshelf-cb");h.addEventListener("change",(function(){h.checked?(a.frequency.setValueAtTime(1e3,t.currentTime),a.gain.setValueAtTime(25,t.currentTime)):a.gain.setValueAtTime(0,t.currentTime)})),d.addEventListener("change",(function(){d.checked?(i.frequency.setValueAtTime(1e3,t.currentTime),i.gain.setValueAtTime(15,t.currentTime)):i.gain.setValueAtTime(10,t.currentTime)}));var v=document.querySelector("#bars-cb"),y=document.querySelector("#circles-cb"),m=document.querySelector("#noise-cb"),g=document.querySelector("#invert-cb");v.addEventListener("change",(function(){M.showBars=v.checked})),y.addEventListener("change",(function(){M.showCircles=y.checked})),m.addEventListener("change",(function(){M.showNoise=m.checked})),g.addEventListener("change",(function(){M.showInvert=g.checked}))},F=function e(){setTimeout(e,1e3/60),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.showFreq&&p.getByteFrequencyData(w),e.showTime&&p.getByteTimeDomainData(w),A.push(new S(40,40,3,"red",50,30)),A.push(new S(400,40,3,"blue",50,30)),m.save(),m.fillStyle="black",m.globalAlpha=.1,m.fillRect(0,0,g,b),m.restore();for(var t=0,n=A;t<n.length;t++){var r=n[t];r.update(e),r.draw(m)}if(e.showBars){var o=b/2,a=g/2;m.save(),m.translate(a,o/2-100);var i,c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}(w);try{for(c.s();!(i=c.n()).done;){var s=i.value,f=s/255;f<.02&&(f=.02),m.translate(10,0),m.rotate(2*Math.PI/128),m.save(),m.rotate(q),m.scale(1,-1),m.fillStyle="rgba(".concat(s,",").concat(s-128,",").concat(255-s,",.3)"),m.fillRect(0,0,10,100*f*(e.volumeLevel/100)),m.restore(),m.translate(2,0)}}catch(e){c.e(e)}finally{c.f()}m.restore(),q+=.01}if(e.showCircles){var d=2*e.volumeLevel;m.save(),m.globalAlpha=.5;for(var v=0;v<w.length;v++){var y=w[v]/255,T=y*d;m.beginPath(),m.fillStyle=l(255,200,200,.34-y/3),m.arc(g/2,e.volumeLevel+b/2-100,T,0,2*Math.PI,!1),m.fill(),m.closePath(),m.beginPath(),m.fillStyle=l(200,200,255,.1-y/10),m.arc(g/2,e.volumeLevel+b/2-100,1.5*T,0,2*Math.PI,!1),m.fill(),m.closePath(),m.beginPath(),m.fillStyle=l(200,200,100,.5-y/5),m.arc(g/2,e.volumeLevel+b/2-100,.5*T,0,2*Math.PI,!1),m.fill(),m.closePath()}m.restore()}for(var M=m.getImageData(0,0,g,b),I=M.data,k=I.length,F=(I.width,I.length,0);F<k;F+=4)if(e.showNoise&&Math.random()<.001&&(I[F]=I[F+1]=I[F+2]=0,I[F]=u(0,255),I[F+1]=u(0,255),I[F+2]=u(0,255)),e.showInvert){var P=I[F],E=I[F+1],L=I[F+2];I[F]=255-P,I[F+1]=255-E,I[F+2]=255-L}m.putImageData(M,0,0)}(M)};window.onload=function(){console.log("window.onload called"),function(){var e,l,h;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((e=function(){return u(35,220)})(),",").concat(e(),",").concat(e(),",1)"))),l=I.sound1,h=window.AudioContext||window.webkitAudioContext,t=new h,n=new Audio,f(l),r=t.createMediaElementSource(n),o=t.createAnalyser(),a=t.createBiquadFilter(),i=t.createBiquadFilter(),a.type="highshelf",i.type="lowshelf",o.fftSize=s.numSamples,(c=t.createGain()).gain.value=s.gain,r.connect(a),a.connect(i),i.connect(o),o.connect(c),c.connect(t.destination);var d=document.querySelector("canvas");k(d),T(d,o),F()}()}})();